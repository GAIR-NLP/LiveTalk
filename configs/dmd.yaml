generator_fsdp_wrap_strategy: size
real_score_fsdp_wrap_strategy: size
fake_score_fsdp_wrap_strategy: size
real_name: ./pretrained_checkpoints/OmniAvatar_merged/pytorch_model_merged_fp32_14B.safetensors
fake_name: ./pretrained_checkpoints/OmniAvatar_merged/pytorch_model_merged_fp32.safetensors
text_encoder_fsdp_wrap_strategy: size

# DMD specific denoising schedule
denoising_step_list:
- 1000
- 936
- 832
- 624
warp_denoising_step: false
ts_schedule: false
num_train_timestep: 1000
timestep_shift: 5.0  # Match ODE config
guidance_scale: 5  # Legacy parameter, use specific ones below instead
denoising_loss_type: flow

# Separate guidance scales for text/visual vs audio
# Real score (teacher model) guidance
real_guidance_scale: 5     # Text/visual guidance for real score
real_audio_guidance_scale: 5 # Audio guidance for real score (match ODE generation)

# Fake score (student critic) guidance
fake_guidance_scale: 0       # Text/visual guidance for fake score
fake_audio_guidance_scale: 0 # Audio guidance for fake score (negative pushes generator toward audio features)

mixed_precision: true
seed: 42
enable_debug_save: true
enable_memory_debug: false

# Wandb settings
wandb_host: WANDB_HOST
wandb_key: WANDB_KEY
wandb_entity: WANDB_ENTITY
wandb_project: WANDB_PROJECT
sharding_strategy: full

# DMD training parameters
lr: 4e-6
lr_critic: 8e-7
beta1: 0.0
beta2: 0.999
beta1_critic: 0.0
beta2_critic: 0.999

# Use text+audio data
data_path: example_dataset/dataset.txt
ode_pairs_dir: example_dataset
max_pair: 100000
wav2vec_model_name: ./pretrained_checkpoints/wav2vec2

batch_size: 1
ema_weight: 0.99
ema_start_step: 200
total_batch_size: 64
log_iters: 100

negative_prompt: '色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走'

dfake_gen_update_ratio: 5

# Video shape configuration (match ODE config)
image_or_video_shape:
- 1
- 21
- 16
- 64
- 64

# Use DMD trainer with CausalWanModel
distribution_loss: dmd
trainer: score_distillation
gradient_checkpointing: true
num_frame_per_block: 3
load_raw_video: false
# CausalWanModel specific settings
model_kwargs:
  model_path: ./pretrained_checkpoints/ODE_init/model.safetensors
  timestep_shift: 5.0
  is_causal: true
  local_attn_size: -1
  sink_size: 0

# Frame configuration
num_training_frames: 21
independent_first_frame: false
i2v: false